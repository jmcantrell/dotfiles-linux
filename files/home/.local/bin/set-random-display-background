#!/usr/bin/env bash

# Set a random background image.
# It's recommended that all files in the given directories are images.

set -euo pipefail

if (($# == 0)); then
    printf "There must be at least one directory given as an argument\n" >&2
    exit 1
fi

file=$(find -L "$@" -type f | shuf -n1)

if [[ -z $file ]]; then
    printf "No files in the given directories\n" >&2
    exit 1
fi

if [[ $(file -b --mime-type "$file") != image/* ]]; then
    printf "File is not an image: %q\n" "$file" >&2
    exit 1
fi

set-display-background "$file"
