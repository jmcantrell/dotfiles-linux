#!/usr/bin/env bash

# Set a random background image.

set -eu

die() {
    printf "%s: line %s: %s\n" "$0" "${BASH_LINENO[0]}" "$1" >&2
    exit "${2:-1}"
}

directory=${1:-${XDG_DATA_HOME:-$HOME/.local/share}/backgrounds}

if [[ ! -d $directory ]]; then
    die "directory does not exist"
fi

file=$(find -L "$directory" -type f | shuf -n1)

if [[ -z $file ]]; then
    die "directory is empty"
fi

set-background "$file"
