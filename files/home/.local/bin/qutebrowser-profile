#!/usr/bin/env bash

# Run qutebrowser in another session, but with the user's configuration.

set -eu

config_dir=${XDG_CONFIG_HOME:-$HOME/.config}/qutebrowser
profiles_dir=${XDG_DATA_HOME:-$HOME/.local/share}/qutebrowser/profiles

profile_name=${1:?Missing profile name}
shift

profile_dir=$profiles_dir/$profile_name

mkdir -p "$profile_dir"
ln -svfrn "$config_dir" "$profile_dir"/config

qutebrowser \
    --basedir "$profile_dir" \
    --desktop-file-name "org.qutebrowser.qutebrowser.$profile_name" \
    "$@"
