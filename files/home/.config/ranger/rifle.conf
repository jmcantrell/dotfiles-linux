mime inode/directory, X = cd "$1" && terminal
mime inode/directory    = cd "$1" && "$SHELL"

match ^https?, label view, flag f = browser -- "$@"
ext   x?html?, label view, flag f = browser -- "$@"

match ^https?, label download, has aria2c = aria2c "$@"
match (^magnet:|.(torrent|metalink)$), label download, has aria2c = aria2c-torrent "$@"
match (^magnet:|.(torrent|metalink)$), label download, has transmission-cli = transmission-cli -- "$@"
match (^magnet:|.(torrent|metalink)$), label download, has transmission-remote, X, flag f = transmission-remote --add -- "$@"

# every text file is editable or pageable
mime ^text, label edit, X, flag f = visual -- "$@"
mime ^text, label edit            = editor -- "$@"
mime ^text, label page            = pager -- "$@"

# some text files do not have a text mimetype
!mime ^text, ext xml|json|csv, label edit, X, flag f = visual -- "$@"
!mime ^text, ext xml|json|csv, label edit            = editor -- "$@"
!mime ^text, ext xml|json|csv, label page            = pager -- "$@"

ext 1 = man "$1"

mime ^image/svg, label edit, has inkscape,       X, flag f = inkscape -- "$@"
mime ^image,     label view, has imv,            X, flag f = imv -- "$@"
mime ^image,     label edit, has gimp,           X, flag f = gimp -- "$@"
mime ^image,     label edit, has krita,          X, flag f = krita -- "$@"
mime ^image,     label edit, has mypaint,        X, flag f = mypaint -- "$@"
mime ^image,     label set,  has set-background, X,        = set-background "$1"

ext m3u|pls, label play, has mpv,  X, flag f   = mpv -- "$@"
ext m3u|pls, label play, has mpv, !X, terminal = mpv -- "$@"

mime ^audio|video, label play, has mpv,  X, flag f   = mpv -- "$@"
mime ^audio|video, label play, has mpv, !X, terminal = mpv -- "$@"

ext pdf|epub|cbz|cbr|djvu, label view, has zathura,      X, flag f = zathura -- "$@"
ext pdf|epub|mobi|azw3,    label view, has ebook-viewer, X, flag f = ebook-viewer "$@"

ext epub, label edit, has sigil, X, flag f = sigil "$@"

ext docx?, label view, has catdoc, terminal = catdoc -- "$@" | pager

ext pptx?|od[dfgpst]|docx?|sxc|xlsx?|xlt|xlw|gnm|gnumeric, label edit, has libreoffice, X, flag f = libreoffice -- "$@"

ext tex, label compile, has latex    = latex -- "$@"
ext dvi, label compile, has dvipdfmx = dvipdfmx -- "$@"

ext 7z, label list, has 7z = 7z -p l "$@" | pager

ext 7z|ace|ar|arc|bz2?|cab|cpio|cpt|deb|dgc|dmg|gz|iso|jar|msi|pkg|rar|shar|tar|tgz|xar|xpi|xz|zip, label list,   has als     = als -- "$@" | pager
ext 7z|ace|ar|arc|bz2?|cab|cpio|cpt|deb|dgc|dmg|gz|iso|jar|msi|pkg|rar|shar|tar|tgz|xar|xpi|xz|zip, label unpack, has aunpack = aunpack -- "$@" | pager

ext tar|gz|bz2|xz, label list,   has tar = tar vvtf -- "$1" | pager
ext tar|gz|bz2|xz, label unpack, has tar = for file in "$@"; do tar vvxf -- "$file"; done

ext bz2, label unpack, has bzip2 = for file in "$@"; do bzip2 -dk -- "$file"; done

ext zip, label list,   has unzip = unzip -l -- "$1" | pager
ext zip, label unpack, has unzip = for file in "$@"; do unzip -d "${file%.*}" -- "$file"; done

ext ace, label list,   has unace = unace l -- "$1" | pager
ext ace, label unpack, has unace = for file in "$@"; do unace e -- "$file"; done

ext rar, label list,   has unrar = unrar l -- "$1" | pager
ext rar, label unpack, has unrar = for file in "$@"; do unrar x -- "$file"; done

mime ^font, label edit, has fontforge, X, flag f = fontforge -- "$@"

mime ^ranger/x-terminal-emulator = terminal -e "$@"

mime application/x-executable = "$1"
