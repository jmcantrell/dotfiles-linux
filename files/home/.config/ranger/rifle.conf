mime inode/directory, X = cd "$1" && terminal
mime inode/directory    = cd "$1" && "$SHELL"

match ^https?, label view, flag f = browser -- "$@"
ext   x?html?, label view, flag f = browser -- "$@"

match (^magnet:|.(torrent|metalink)$), label download, has transmission-gtk, X, flag f = transmission-gtk "$@"
match (^magnet:|.(torrent|metalink)$), label download, has aria2c-torrent              = aria2c-torrent "$@"
match ^https?,                         label download, has aria2c                      = aria2c "$@"

# every text file is editable or pageable
mime ^text, label edit, X, flag f = visual -- "$@"
mime ^text, label edit            = editor -- "$@"
mime ^text, label page            = pager -- "$@"

# some text files do not have a text mimetype
!mime ^text, ext xml|json|csv, label edit, X, flag f = visual -- "$@"
!mime ^text, ext xml|json|csv, label edit            = editor -- "$@"
!mime ^text, ext xml|json|csv, label page            = pager -- "$@"

ext 1 = man "$1"

mime ^image/svg, label edit, has inkscape,               X, flag f = inkscape -- "$@"
mime ^image,     label view, has imv,                    X, flag f = imv -- "$@"
mime ^image,     label edit, has gimp,                   X, flag f = gimp -- "$@"
mime ^image,     label edit, has krita,                  X, flag f = krita -- "$@"
mime ^image,     label edit, has mypaint,                X, flag f = mypaint -- "$@"
mime ^image,     label set,  has set-display-background, X,        = set-display-background "$1"

# audio has no gui, so terminal is needed to see progress
ext m3u|pls, label play, has mpv, X, flag f = terminal -e mpv -- "$@"
mime ^audio, label play, has mpv, X, flag f = terminal -e mpv -- "$@"

# video window is used as a gui, so no need for the terminal
mime ^video, label play, has mpv, X, flag f = mpv -- "$@"

# at the console, no need to fork
ext m3u|pls,       label play, has mpv, !X, terminal = mpv -- "$@"
mime ^audio|video, label play, has mpv, !X, terminal = mpv -- "$@"

ext pdf|epub|cbz|cbr|djvu, label view, has zathura,      X, flag f = zathura -- "$@"
ext pdf|epub|mobi|azw3,    label view, has ebook-viewer, X, flag f = ebook-viewer "$@"

ext epub, label edit, has sigil, X, flag f = sigil "$@"

ext docx?, label view, has catdoc, terminal = catdoc -- "$@" | pager

ext pptx?|od[dfgpst]|docx?|sxc|xlsx?|xlt|xlw|gnm|gnumeric, label edit, has libreoffice, X, flag f = libreoffice -- "$@"

ext tex, label compile, has latex    = latex -- "$@"
ext dvi, label compile, has dvipdfmx = dvipdfmx -- "$@"

ext 7z|ace|ar|arc|bz2?|cab|cpio|cpt|deb|dgc|dmg|gz|jar|msi|pkg|rar|shar|tar|tgz|xar|xpi|xz|zip|zst, label list,   has als     = als -- "$@" | pager
ext 7z|ace|ar|arc|bz2?|cab|cpio|cpt|deb|dgc|dmg|gz|jar|msi|pkg|rar|shar|tar|tgz|xar|xpi|xz|zip|zst, label unpack, has aunpack = aunpack -- "$@" | pager

mime ^font, label edit, has fontforge, X, flag f = fontforge -- "$@"

mime ^ranger/x-terminal-emulator = terminal -e "$@"

mime application/x-executable = "$1"
