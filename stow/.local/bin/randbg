#!/usr/bin/env bash

# Set desktop background to a random image from a directory.
# Usage: randbg [DIRECTORY]

set -eu

backgrounds_dir=${1:-${XDG_DATA_HOME:-$HOME/.local/share}/backgrounds}

die() {
    printf "ERROR: %s\n" "$@" >&2
    exit 1
}

if [[ ! -d $backgrounds_dir ]]; then
    die "Backgrounds directory does not exist!"
fi

background_file=$(find -L "$backgrounds_dir" -type f | shuf -n1)

if [[ ! -f $background_file ]]; then
    die "Backgrounds directory is empty!"
fi

setbg "$background_file"
