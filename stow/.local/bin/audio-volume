#!/usr/bin/env bash

# Set the audio volume and show a notification.

set -euo pipefail

action=${1:?missing action}

increment=5

case $action in
mute) pamixer --toggle-mute ;;
down) pamixer --decrease $increment ;;
up) pamixer --increase $increment ;;
max) pamixer --set-volume 100 ;;
esac

# The exit code corresponds to mute status.
muted=$(pamixer --get-mute) || true # -e will cause exit otherwise

volume=$(pamixer --get-volume)

canberra-gtk-play -i message &

icon="audio-volume-high"
[[ $muted == true ]] && icon="audio-volume-muted"

notify-send -u low -i "$icon" -h int:value:"$volume" \
    -h string:x-canonical-private-synchronous:audio-volume \
    "Volume Control" "Muted: <b>$muted</b><br>Volume: <b>$volume%</b>"
