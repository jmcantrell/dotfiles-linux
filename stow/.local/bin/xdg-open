#!/usr/bin/env bash

set -eu

files=()

for file_or_url in "$@"; do
    if [[ $file_or_url == file://* ]]; then
        # Since we're masquerading as xdg-open, we need to handle encoded file URLs
        # like: file:///path/to/file+with+spaces.txt
        files+=("$(urldecode "${file_or_url#file://}")")
    else
        # Other URLs (http, etc.) should be handled directly by rifle.
        files+=("$file_or_url")
    fi
done

exec rifle "${files[@]}"
