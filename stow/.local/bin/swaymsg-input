#!/usr/bin/env bash

# Prompt the user for a sway command.

set -eu

prompt=input
ipc_command=(swaymsg)

while getopts "p:s:" option; do
    case $option in
    p) prompt=$OPTARG ;;
    s) ipc_command+=(-s "$OPTARG") ;;
    esac
done && shift $((OPTIND - 1))

format=${1:?Missing message format}
shift

reply=$(bemenu -p "$prompt" </dev/null)
printf -v message "$format" "$reply"
exec "${ipc_command[@]}" "$message"
