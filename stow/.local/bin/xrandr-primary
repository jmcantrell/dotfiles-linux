#!/usr/bin/env bash

# Set the primary output, and persist it for future logins.
# Usage: xrandr-primary [OUTPUT]

set -eu

output=${1:-}

if [[ -z $output ]]; then
    xrandr | grep -w primary | cut -d' ' -f1
    exit 0
fi

exec_cmd=(xrandr --output "$output" --primary)

autostart=${XDG_CONFIG_HOME:-$HOME/.config}/autostart/xrandr-primary.desktop

mkdir -p "$(dirname "$autostart")"

cat >"$autostart" <<-EOF
[Desktop Entry]
Name=${0##*/}
Comment=set the primary display
Exec=${exec_cmd[*]}
Type=Application
EOF

exec "${exec_cmd[@]}" &
