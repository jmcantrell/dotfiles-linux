#!/usr/bin/env bash

# Wrapper for i3lock to define a lock image and disable dunst.

# disable notifications while locked
notify-send DUNST_COMMAND_PAUSE

# create obscured screenshot of desktop
image=$(mktemp --suffix=.png)
trap "rm -f $(printf "%q" "$image")" INT TERM EXIT
import -window root "$image"
mogrify -scale 10% -scale 1000% "$image"  # pixelate
# mogrify -blur '0x6' "$image"            # blur

/usr/bin/i3lock -nt -p default -i "$image" "$@"

# enable notifications after unlocking
notify-send DUNST_COMMAND_RESUME
