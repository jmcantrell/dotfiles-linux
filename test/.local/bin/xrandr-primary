#!/usr/bin/env bash

# Set the primary output, and ensure save it.
# Usage: xrandr-primary [output]

config=${XDG_CONFIG_HOME:-$HOME/.config}

primary() {
	local primary=$(xrandr | grep '\bprimary\b' | cut -d' ' -f1)
	test "$primary" || return 1
	echo "$primary"
}

outputs() {
	xrandr | grep '\bconnected\b' | cut -d' ' -f1
}

output=$1
# none given, so just show current
test "$output" || primary && exit

entry="
[Desktop Entry]
Type=Application
Name=Set Primary Display
Exec=xrandr --output '$output' --primary
"
autostart=$config/autostart
mkdir -p "$autostart"
echo "$entry" >"$autostart"/xrandr-primary.desktop

xrandr --output "$output" --primary
